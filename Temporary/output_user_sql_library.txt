test generating output 04 - test 01 - different methods in different rows
SELECT var_layer1 as layer1, var_layer2 as layer2, var_layer3 as layer3, var_layer4 as layer4,var_layer5 as layer5, var_layer6 as layer6, (var_method || '_' || var_forest_status) AS method_status, var_value as grouped_acres

FROM output_05_management_details
WHERE CAST(var_period AS DECIMAL) = 1

GROUP BY (layer1 || layer2 || layer3 || layer4 || layer5 || layer6 || method_status)
ORDER BY (layer1 || layer2 || layer3 || layer4 || layer5 || layer6 || method_status)
----------
acres by existing strata, period 1, existing method  (exact output04)
SELECT strata_id, layer1, layer2, layer3, layer4, layer5, layer6,
SUM(CASE WHEN t.method_status = 'NGE' THEN t.grouped_acres END) AS NG_E_acres,
SUM(CASE WHEN t.method_status = 'PBE' THEN t.grouped_acres END) AS PB_E_acres,
SUM(CASE WHEN t.method_status = 'GSE' THEN t.grouped_acres END) AS GS_E_acres,
SUM(CASE WHEN t.method_status = 'EAE' THEN t.grouped_acres END) AS EA_E_acres,
SUM(CASE WHEN t.method_status = 'MSE' THEN t.grouped_acres END) AS MS_E_acres,
SUM(CASE WHEN t.method_status = 'BSE' THEN t.grouped_acres END) AS BS_E_acres
FROM


(SELECT 
(var_layer1 || var_layer2 || var_layer3 || var_layer4 || var_layer5 || var_layer6) as strata_id,
var_layer1 as layer1, var_layer2 as layer2, var_layer3 as layer3, var_layer4 as layer4,var_layer5 as layer5, var_layer6 as layer6, (var_method || var_forest_status) AS method_status, var_value as grouped_acres
FROM output_05_management_details
WHERE CAST(var_period AS DECIMAL) = 1
GROUP BY (layer1 || layer2 || layer3 || layer4 || layer5 || layer6 || method_status)
ORDER BY (layer1 || layer2 || layer3 || layer4 || layer5 || layer6 || method_status)) AS t


GROUP BY strata_id
----------
acres by period, method
SELECT period,
SUM(CASE WHEN t.method = 'NG' THEN t.grouped_acres END) AS NG_acres,
SUM(CASE WHEN t.method = 'PB' THEN t.grouped_acres END) AS PB_acres,
SUM(CASE WHEN t.method = 'GS' THEN t.grouped_acres END) AS GS_acres,
SUM(CASE WHEN t.method = 'EA' THEN t.grouped_acres END) AS EA_acres,
SUM(CASE WHEN t.method = 'MS' THEN t.grouped_acres END) AS MS_acres,
SUM(CASE WHEN t.method = 'BS' THEN t.grouped_acres END) AS BS_acres
FROM


(SELECT 
CAST(var_period AS DECIMAL) as period,
var_method as method, SUM(var_value) as grouped_acres
FROM output_05_management_details
GROUP BY (period || method)
ORDER BY (period || method)) AS t


GROUP BY period
----------
acres by period, method, forest_status
SELECT period,
SUM(CASE WHEN t.method_status = 'NGE' THEN t.grouped_acres END) AS NG_E_acres,
SUM(CASE WHEN t.method_status = 'PBE' THEN t.grouped_acres END) AS PB_E_acres,
SUM(CASE WHEN t.method_status = 'GSE' THEN t.grouped_acres END) AS GS_E_acres,
SUM(CASE WHEN t.method_status = 'EAE' THEN t.grouped_acres END) AS EA_E_acres,
SUM(CASE WHEN t.method_status = 'MSE' THEN t.grouped_acres END) AS MS_E_acres,
SUM(CASE WHEN t.method_status = 'BSE' THEN t.grouped_acres END) AS BS_E_acres,
SUM(CASE WHEN t.method_status = 'NGR' THEN t.grouped_acres END) AS NG_R_acres,
SUM(CASE WHEN t.method_status = 'PBR' THEN t.grouped_acres END) AS PB_R_acres,
SUM(CASE WHEN t.method_status = 'GSR' THEN t.grouped_acres END) AS GS_R_acres,
SUM(CASE WHEN t.method_status = 'EAR' THEN t.grouped_acres END) AS EA_R_acres
FROM


(SELECT 
CAST(var_period AS DECIMAL) as period,
(var_method || var_forest_status) AS method_status, SUM(var_value) as grouped_acres
FROM output_05_management_details
GROUP BY (period || method_status)
ORDER BY (period || method_status)) AS t


GROUP BY period
----------
acres by period, method, forest_status, activity
SELECT period, action_type as activity,
SUM(CASE WHEN t.method_status = 'NGE' THEN t.grouped_acres END) AS NG_E_acres,
SUM(CASE WHEN t.method_status = 'PBE' THEN t.grouped_acres END) AS PB_E_acres,
SUM(CASE WHEN t.method_status = 'GSE' THEN t.grouped_acres END) AS GS_E_acres,
SUM(CASE WHEN t.method_status = 'EAE' THEN t.grouped_acres END) AS EA_E_acres,
SUM(CASE WHEN t.method_status = 'MSE' THEN t.grouped_acres END) AS MS_E_acres,
SUM(CASE WHEN t.method_status = 'BSE' THEN t.grouped_acres END) AS BS_E_acres,
SUM(CASE WHEN t.method_status = 'NGR' THEN t.grouped_acres END) AS NG_R_acres,
SUM(CASE WHEN t.method_status = 'PBR' THEN t.grouped_acres END) AS PB_R_acres,
SUM(CASE WHEN t.method_status = 'GSR' THEN t.grouped_acres END) AS GS_R_acres,
SUM(CASE WHEN t.method_status = 'EAR' THEN t.grouped_acres END) AS EA_R_acres
FROM


(SELECT 
CAST(var_period AS DECIMAL) as period, action_type,
(var_method || var_forest_status) AS method_status, SUM(var_value) as grouped_acres
FROM output_05_management_details
GROUP BY (period || action_type || method_status)
ORDER BY (period || action_type  || method_status)) AS t


GROUP BY period, action_type
----------
vacuum
vacuum
----------
test Rounded
SELECT period,
ROUND(SUM(CASE WHEN t.method = 'NG' AND t.volume > 0 THEN t.volume END), 1) AS NG_volume,
ROUND(SUM(CASE WHEN t.method = 'PB' AND t.volume > 0 THEN t.volume  END), 1) AS PB_volume,
ROUND(SUM(CASE WHEN t.method = 'GS' AND t.volume > 0 THEN t.volume  END), 1) AS GS_volume,
ROUND(SUM(CASE WHEN t.method = 'EA' AND t.volume > 0 THEN t.volume  END), 1) AS EA_volume,
ROUND(SUM(CASE WHEN t.method = 'MS' AND t.volume > 0 THEN t.volume  END), 1) AS MS_volume,
ROUND(SUM(CASE WHEN t.method = 'BS' AND t.volume > 0 THEN t.volume  END), 1) AS BS_volume,
ROUND(SUM(CASE WHEN t.volume > 0 THEN t.volume  END), 1) AS total_volume
FROM


(SELECT 
CAST(var_period AS DECIMAL) as period, var_method as method, 
SUM(var_value*rmcuft) as volume
FROM output_05_management_details
GROUP BY (period || method)
ORDER BY (period || method)) AS t


GROUP BY period
----------
2 cols
Select var_name, var_unit_management_cost from output_05_management_details
----------
all
select * from output_05_management_details
----------
test summarize loss rate from all iteartions - iterration 1st
SELECT iteration, period, sr_area
FROM


(SELECT 
CAST(iteration AS DECIMAL) as iteration, 
CAST(var_period AS DECIMAL) as period, 
ROUND(SUM(var_value*loss_rate_total/100), 1) as sr_area
FROM summarize_output_05_management_details
GROUP BY (iteration || period)
)


ORDER BY iteration, period
----------
test summarize loss rate from all iteartions - period 1st
SELECT period, iteration, sr_area
FROM


(SELECT 
CAST(iteration AS DECIMAL) as iteration, 
CAST(var_period AS DECIMAL) as period, 
ROUND(SUM(var_value*loss_rate_total/100), 1) as sr_area
FROM summarize_output_05_management_details
GROUP BY (iteration || period)
)


ORDER BY period, iteration
----------
test summarize loss area for all methods
SELECT iteration, period,
SUM(CASE WHEN t.method = 'NG' THEN t.grouped_area END) AS NG_area,
SUM(CASE WHEN t.method = 'PB' THEN t.grouped_area END) AS PB_area,
SUM(CASE WHEN t.method = 'GS' THEN t.grouped_area END) AS GS_area,
SUM(CASE WHEN t.method = 'EA' THEN t.grouped_area END) AS EA_area,
SUM(CASE WHEN t.method = 'MS' THEN t.grouped_area END) AS MS_area,
SUM(CASE WHEN t.method = 'BS' THEN t.grouped_area END) AS BS_area
FROM


(SELECT 
CAST(iteration AS DECIMAL) as iteration,
CAST(var_period AS DECIMAL) as period,
var_method as method, ROUND(SUM(var_value*loss_rate_total/100), 1) as grouped_area
FROM summarize_output_05_management_details
GROUP BY iteration, (period || method)
) AS t


GROUP BY iteration, period
----------
all records
Select * FROM summarize_output_05_management_details INNER JOIN yield_tables USING  (prescription, row_id)
----------
all records - Left join to allow missing row id
Select * FROM summarize_output_05_management_details LEFT JOIN yield_tables USING  (prescription, row_id)
----------